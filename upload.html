{% extends "layout/base.html" %}

{% block title %}Upload - Keyword Search Engine{% endblock %}

{% block content %}
<style>
/* Container style for the page */
.container {
    width: 80%;
    margin: 0 auto;
    padding: 20px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

/* Main heading style */
h1 {
    font-size: 2.5em;
    color: darkblue;
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
    text-align: center;
}

/* Subheading style */
h2 {
    margin-bottom: 10px;
    text-align: center;
}

/* Style for smaller headings */
.small-heading {
    font-size: 1.2em;
    text-align: center;
    margin-top: 40px;
}

/* Table styling for displaying uploaded documents */
table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
}

table, th, td {
    border: 1px solid #ccc;
}

th, td {
    padding: 10px;
    text-align: center;
}

th {
    background-color: #f2f2f2;
}

/* Styling for the buttons container */
.button-container {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    margin-top: 15px;
}

/* Style for the file input field */
input[type="file"] {
    font-size: 16px;
    padding: 6px;
}

/* Style for the upload button */
.upload-btn {
    border: 1px solid #ccc;
    cursor: pointer;
    font-size: 16px;
    padding: 6px 10px;
    background-color: #0d0668;
    color: white;
    border-radius: 4px;
    transition: 0.3s ease;
}

/* Hover effect for the upload button */
.upload-btn:hover {
    background-color: #0056b3;
}


/* Styling for alert messages (success, danger, etc.) */
.alert {
    width: 60%;
    margin: 20px auto;
    padding: 10px;
    border-radius: 5px;
    text-align: center;
}

/* Success message style */
.alert-success {
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
}

/* Error message style */
.alert-danger {
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
}

/* Warning message style */
.alert-warning {
    background-color: #fff3cd;
    color: #856404;
    border: 1px solid #ffeeba;
}

/* Info message style */
.alert-info {
    background-color: #d1ecf1;
    color: #0c5460;
    border: 1px solid #bee5eb;
}
</style>

<div class="container">
  <h1>Keyword Based Search Engine For Text Document</h1>

  <!-- Feedback Messages: Display success, danger, or info messages to the user -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }}">{{ message }}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <h2>Upload a Text Document</h2>
  
  <!-- Form for uploading a document -->
  <form action="{{ url_for('upload_document') }}" method="POST" enctype="multipart/form-data">
    <div class="button-container">
      <!-- File input field for selecting documents (txt, csv) -->
      <input type="file" name="file" accept=".txt,.csv" multiple required>
      <!-- Upload button to submit the form -->
      <button type="submit" class="upload-btn">Upload</button>
    </div>
  </form>

  <h2 class="small-heading">Uploaded Documents</h2>
  
  <!-- Table to display the uploaded documents -->
  <table>
    <tr>
      <th>File Name</th>
      <th>Upload Date</th>
    </tr>
    {% if documents %}
      {% for doc in documents %}
      <tr>
        <td>{{ doc.filename }}</td>
        <td>{{ doc.upload_date.strftime('%Y-%m-%d %H:%M:%S') }}</td>
      </tr>
      {% endfor %}
    {% else %}
      <tr>
        <td colspan="2">No documents uploaded yet.</td>
      </tr>
    {% endif %}
  </table>

  <!-- Admin functionality: Clear all documents option (Only visible to admin) -->
  {% if documents and session.get('email') == 'eshalrajput@gmail.com' %}
  <form action="{{ url_for('admin_clear_documents') }}" method="POST" onsubmit="return confirm('Are you sure you want to clear all documents?');">
    <button type="submit" class="clear-btn">Clear All Documents</button>
  </form>
  {% endif %}
</div>
{% endblock %}
